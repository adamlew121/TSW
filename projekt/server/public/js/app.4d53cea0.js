(function(e){function t(t){for(var n,a,o=t[0],c=t[1],u=t[2],d=0,l=[];d<o.length;d++)a=o[d],Object.prototype.hasOwnProperty.call(s,a)&&s[a]&&l.push(s[a][0]),s[a]=0;for(n in c)Object.prototype.hasOwnProperty.call(c,n)&&(e[n]=c[n]);f&&f(t);while(l.length)l.shift()();return i.push.apply(i,u||[]),r()}function r(){for(var e,t=0;t<i.length;t++){for(var r=i[t],n=!0,o=1;o<r.length;o++){var c=r[o];0!==s[c]&&(n=!1)}n&&(i.splice(t--,1),e=a(a.s=r[0]))}return e}var n={},s={app:0},i=[];function a(t){if(n[t])return n[t].exports;var r=n[t]={i:t,l:!1,exports:{}};return e[t].call(r.exports,r,r.exports,a),r.l=!0,r.exports}a.m=e,a.c=n,a.d=function(e,t,r){a.o(e,t)||Object.defineProperty(e,t,{enumerable:!0,get:r})},a.r=function(e){"undefined"!==typeof Symbol&&Symbol.toStringTag&&Object.defineProperty(e,Symbol.toStringTag,{value:"Module"}),Object.defineProperty(e,"__esModule",{value:!0})},a.t=function(e,t){if(1&t&&(e=a(e)),8&t)return e;if(4&t&&"object"===typeof e&&e&&e.__esModule)return e;var r=Object.create(null);if(a.r(r),Object.defineProperty(r,"default",{enumerable:!0,value:e}),2&t&&"string"!=typeof e)for(var n in e)a.d(r,n,function(t){return e[t]}.bind(null,n));return r},a.n=function(e){var t=e&&e.__esModule?function(){return e["default"]}:function(){return e};return a.d(t,"a",t),t},a.o=function(e,t){return Object.prototype.hasOwnProperty.call(e,t)},a.p="/";var o=window["webpackJsonp"]=window["webpackJsonp"]||[],c=o.push.bind(o);o.push=t,o=o.slice();for(var u=0;u<o.length;u++)t(o[u]);var f=c;i.push([0,"chunk-vendors"]),r()})({0:function(e,t,r){e.exports=r("56d7")},"03de":function(e,t,r){},"0cc6":function(e,t,r){"use strict";var n=r("8474"),s=r.n(n);s.a},1:function(e,t){},1314:function(e,t,r){},"135e":function(e,t,r){"use strict";var n=r("1eb4"),s=r.n(n);s.a},1783:function(e,t,r){"use strict";var n=r("222b"),s=r.n(n);s.a},"1eb4":function(e,t,r){},"222b":function(e,t,r){},"24a7":function(e,t,r){"use strict";var n=r("d8da"),s=r.n(n);s.a},"38ea":function(e,t,r){},"3adb":function(e,t,r){"use strict";var n=r("1314"),s=r.n(n);s.a},"4ed5":function(e,t,r){"use strict";var n=r("dceb"),s=r.n(n);s.a},"53a9":function(e,t,r){"use strict";var n=r("b8a8"),s=r.n(n);s.a},"56d7":function(e,t,r){"use strict";r.r(t);r("e260"),r("e6cf"),r("cca6"),r("a79d");var n=r("a026"),s=function(){var e=this,t=e.$createElement,r=e._self._c||t;return r("div",{attrs:{id:"main-app"}},[r("page-header"),r("router-view")],1)},i=[],a=function(){var e=this,t=e.$createElement,r=e._self._c||t;return r("div",{staticClass:"navBar"},[r("nav",[e.$store.state.isUserLoggedIn?e._e():r("router-link",{staticClass:"navElem",attrs:{to:"/login"}},[e._v("Login")]),e.$store.state.isUserLoggedIn?e._e():r("router-link",{staticClass:"navElem",attrs:{to:"/register"}},[e._v("Register")]),e.$store.state.isUserLoggedIn?r("router-link",{staticClass:"navElem",attrs:{to:"/historyBidding"}},[e._v("Active-Biddings")]):e._e(),e.$store.state.isUserLoggedIn?r("router-link",{staticClass:"navElem",attrs:{to:"/history"}},[e._v("History")]):e._e(),e.$store.state.isUserLoggedIn?r("router-link",{staticClass:"navElem",attrs:{to:"/chats"}},[e._v("Chats")]):e._e(),r("router-link",{staticClass:"navElem",attrs:{to:"/offers"}},[e._v("Offers")]),e.$store.state.isUserLoggedIn?r("button",{staticClass:"navElem",on:{click:e.logout}},[e._v("Log Out")]):e._e()],1),e.$store.state.isUserLoggedIn?r("div",{staticClass:"userData"},[e._v(" Zalogowany: "+e._s(e.$store.state.user.username)+" ")]):e._e()])},o=[],c={methods:{logout:function(){this.$store.dispatch("setToken",null),this.$store.dispatch("setUser",null),this.$router.push({name:"offers"})}}},u=c,f=(r("3adb"),r("2877")),d=Object(f["a"])(u,a,o,!1,null,"133ca8de",null),l=d.exports,p={name:"App",components:{PageHeader:l}},g=p,h=Object(f["a"])(g,s,i,!1,null,null,null),v=h.exports,m=r("8c4f"),b=function(){var e=this,t=e.$createElement,r=e._self._c||t;return r("div",{staticClass:"main-app"},[r("h1",[e._v("Register")]),r("br"),r("input",{directives:[{name:"model",rawName:"v-model",value:e.username,expression:"username"}],staticClass:"cstInput",attrs:{type:"text",name:"username",placeholder:"username"},domProps:{value:e.username},on:{input:function(t){t.target.composing||(e.username=t.target.value)}}}),r("br"),r("input",{directives:[{name:"model",rawName:"v-model",value:e.password,expression:"password"}],staticClass:"cstInput",attrs:{type:"password",name:"password",placeholder:"password"},domProps:{value:e.password},on:{input:function(t){t.target.composing||(e.password=t.target.value)}}}),r("br"),r("div",{domProps:{innerHTML:e._s(e.error)}}),r("button",{staticClass:"cstButton",on:{click:e.register}},[e._v("Register")])])},_=[],w=(r("96cf"),r("1da1")),x=r("bc3a"),k=r.n(x),P=function(){return k.a.create({baseURL:"https://"+window.location.hostname,withCredentials:!0})},$={register:function(e){return P().post("register",e)},login:function(e){return P().post("login",e)},show:function(e){return P().get("user/".concat(e))}},O={data:function(){return{username:"",password:"",error:""}},methods:{register:function(){var e=this;return Object(w["a"])(regeneratorRuntime.mark((function t(){var r;return regeneratorRuntime.wrap((function(t){while(1)switch(t.prev=t.next){case 0:if(!(e.username.length>0&&e.password.length>0)){t.next=12;break}return t.prev=1,t.next=4,$.register({username:e.username,password:e.password});case 4:r=t.sent,console.log(r),e.$router.push({name:"offers"}),t.next=12;break;case 9:t.prev=9,t.t0=t["catch"](1),e.error=t.t0.response.data.error;case 12:case"end":return t.stop()}}),t,null,[[1,9]])})))()}},mounted:function(){this.$store.state.isUserLoggedIn&&this.$router.push({name:"offers"})}},y=O,I=(r("135e"),Object(f["a"])(y,b,_,!1,null,"640c1fa4",null)),C=I.exports,B=function(){var e=this,t=e.$createElement,r=e._self._c||t;return r("div",{staticClass:"main-app"},[r("h1",[e._v("Login")]),r("input",{directives:[{name:"model",rawName:"v-model",value:e.username,expression:"username"}],staticClass:"cstInput",attrs:{type:"text",name:"username",placeholder:"username"},domProps:{value:e.username},on:{input:function(t){t.target.composing||(e.username=t.target.value)}}}),r("br"),r("input",{directives:[{name:"model",rawName:"v-model",value:e.password,expression:"password"}],staticClass:"cstInput",attrs:{type:"password",name:"password",placeholder:"password"},domProps:{value:e.password},on:{input:function(t){t.target.composing||(e.password=t.target.value)}}}),r("br"),r("div",{domProps:{innerHTML:e._s(e.error)}}),r("button",{staticClass:"cstButton",on:{click:e.login}},[e._v("Login")])])},S=[],L={data:function(){return{username:"",password:"",error:""}},methods:{login:function(){var e=this;return Object(w["a"])(regeneratorRuntime.mark((function t(){var r;return regeneratorRuntime.wrap((function(t){while(1)switch(t.prev=t.next){case 0:if(!(e.username.length>0&&e.password.length>0)){t.next=13;break}return t.prev=1,t.next=4,$.login({username:e.username,password:e.password});case 4:r=t.sent,console.log(r.data),e.$store.commit("login",r.data.user),e.$router.push({name:"notifications"}),t.next=13;break;case 10:t.prev=10,t.t0=t["catch"](1),e.error=t.t0.response.data.error;case 13:case"end":return t.stop()}}),t,null,[[1,10]])})))()}},mounted:function(){this.$store.state.isUserLoggedIn&&this.$router.push({name:"notifications"})}},U=L,E=(r("0cc6"),Object(f["a"])(U,B,S,!1,null,"1e5d8167",null)),R=E.exports,j=function(){var e=this,t=e.$createElement,r=e._self._c||t;return r("div",{staticClass:"main-app"},[e.canCreateOffer()?r("div",[r("button",{staticClass:"createButton",on:{click:function(t){return e.navigateTo({name:"offers-create"})}}},[e._v("Create Offer ")])]):e._e(),r("div",{staticClass:"cstGrid"},e._l(e.visibleOffers,(function(t){return r("div",{key:t.id,staticClass:"cstGridField"},[e._v(" "+e._s(e.isAuthor(t)?"AUTHOR":"")+" "+e._s(!e.isAuthor(t)&&t.closed?"CLOSED":"")+" "+e._s(e.isAuthor(t)||t.closed?"":"OPEN")+" "),r("br"),e._v(" "+e._s(t.title)+" "),r("br"),e._v(" "+e._s(t.price)+" "),r("br"),e._v(" "+e._s(e.getOption(t))+" "),r("br"),r("button",{on:{click:function(r){return e.navigateTo({name:"offer",params:{offerId:t._id}})}}},[e._v(" View Offer ")])])})),0),e.totalPages()>0?r("div",{staticClass:"pagination"},[e.showPreviousLink()?r("span",{staticClass:"pagination-btn",on:{click:function(t){return e.updatePage(e.currentPage-1)}}},[e._v(" < ")]):e._e(),e._v(" "+e._s(e.currentPage+1)+" of "+e._s(e.totalPages())+" "),e.showNextLink()?r("span",{staticClass:"pagination-btn",on:{click:function(t){return e.updatePage(e.currentPage+1)}}},[e._v(" > ")]):e._e()]):e._e()])},A=[],N=(r("fb6a"),{index:function(){return P().get("offers")},history:function(){return P().get("history")},historyBidding:function(){return P().get("historyBidding")},post:function(e){return P().post("offers",e)},show:function(e){return P().get("offers/".concat(e))},put:function(e){return P().put("offers/".concat(e._id),e)},buy:function(e){return P().put("offers/".concat(e._id,"/buy"),e)},start:function(e){return P().put("offers/".concat(e._id,"/start"),e)},finish:function(e){return P().put("offers/".concat(e._id,"/finish"),e)},bid:function(e){return P().put("offers/".concat(e.offerId,"/bid"),{price:e.price})},indexBids:function(e){return P().get("offers/".concat(e,"/bids"))}}),T={data:function(){return{offers:{},visibleOffers:{},currentPage:0,pageSize:9}},methods:{navigateTo:function(e){this.$router.push(e)},updateVisibleOffers:function(){this.visibleOffers=this.offers.slice(this.currentPage*this.pageSize,this.currentPage*this.pageSize+this.pageSize),0===this.visibleOffers.length&&this.currentPage>0&&this.updatePage(this.currentPage-1)},updatePage:function(e){this.currentPage=e,this.updateVisibleOffers()},totalPages:function(){return Math.ceil(this.offers.length/this.pageSize)},showPreviousLink:function(){return 0!==this.currentPage},showNextLink:function(){return this.currentPage!==this.totalPages()-1},isAuthor:function(e){return this.$store.state.isUserLoggedIn&&e.author===this.$store.state.user._id},canCreateOffer:function(){return this.$store.state.isUserLoggedIn},getOption:function(e){return e.bidding&&1===e.biddingStatus?"Bidding not started":e.bidding||e.closed?e.closed?"Bought":e.bidding&&2===e.biddingStatus?"Bidding in progress":void 0:"Buy now"}},mounted:function(){var e=this;return Object(w["a"])(regeneratorRuntime.mark((function t(){return regeneratorRuntime.wrap((function(t){while(1)switch(t.prev=t.next){case 0:return t.next=2,N.index();case 2:e.offers=t.sent.data,e.updateVisibleOffers();case 4:case"end":return t.stop()}}),t)})))()}},z=T,D=(r("a797"),Object(f["a"])(z,j,A,!1,null,"6c1092d4",null)),M=D.exports,V=function(){var e=this,t=e.$createElement,r=e._self._c||t;return r("div",{staticClass:"offer-create"},[e._v(" Create offer "),r("br"),r("input",{directives:[{name:"model",rawName:"v-model",value:e.offer.title,expression:"offer.title"}],attrs:{type:"text",name:"title",placeholder:"Title"},domProps:{value:e.offer.title},on:{input:function(t){t.target.composing||e.$set(e.offer,"title",t.target.value)}}}),r("br"),e._v(" Allow bidding "),r("input",{directives:[{name:"model",rawName:"v-model",value:e.offer.bidding,expression:"offer.bidding"}],attrs:{type:"checkbox",name:"bidding",placeholder:"Bidding"},domProps:{checked:Array.isArray(e.offer.bidding)?e._i(e.offer.bidding,null)>-1:e.offer.bidding},on:{change:function(t){var r=e.offer.bidding,n=t.target,s=!!n.checked;if(Array.isArray(r)){var i=null,a=e._i(r,i);n.checked?a<0&&e.$set(e.offer,"bidding",r.concat([i])):a>-1&&e.$set(e.offer,"bidding",r.slice(0,a).concat(r.slice(a+1)))}else e.$set(e.offer,"bidding",s)}}}),r("br"),r("input",{directives:[{name:"model",rawName:"v-model",value:e.offer.price,expression:"offer.price"}],attrs:{type:"number",name:"price",placeholder:"Price"},domProps:{value:e.offer.price},on:{input:function(t){t.target.composing||e.$set(e.offer,"price",t.target.value)}}}),r("br"),r("button",{on:{click:e.create}},[e._v("Post Offer")])])},F=[],G={data:function(){return{offer:{title:null,bidding:!1,price:null,author:null}}},methods:{create:function(){var e=this;return Object(w["a"])(regeneratorRuntime.mark((function t(){return regeneratorRuntime.wrap((function(t){while(1)switch(t.prev=t.next){case 0:return t.prev=0,e.offer.author=e.$store.state.user._id,t.next=4,N.post(e.offer);case 4:e.$router.push({name:"offers"}),t.next=10;break;case 7:t.prev=7,t.t0=t["catch"](0),console.log(t.t0);case 10:case"end":return t.stop()}}),t,null,[[0,7]])})))()}},mounted:function(){this.$store.state.isUserLoggedIn||this.$router.push({name:"offers"})}},H=G,Y=(r("789d"),Object(f["a"])(H,V,F,!1,null,"2a51db2e",null)),J=Y.exports,Z=function(){var e=this,t=e.$createElement,r=e._self._c||t;return r("div",{staticClass:"offer-create"},[e._v(" Offer Details "),r("hr"),r("p",[e._v(" "+e._s(e.offer.title)+" ")]),r("p",[e._v(" "+e._s(e.canEnterBidding?"":e.offer.price+" USD")+" ")]),r("p",[e._v(" Created by "+e._s(e.author.username)+" ")]),r("p",[e._v(" "+e._s(e.canBuy?"Buy now":"")+" "+e._s(e.canEnterBidding?"Bidding in progress":"")+" "+e._s(e.canStartBidding?"Click button to start bidding":"")+" "+e._s(e.canFinishBidding?"Click button to finish bidding":"")+" ")]),r("hr"),!e.isAuthor(e.offer)&&e.isLoggedIn()?r("div",[r("button",{on:{click:function(t){return e.navigateTo({name:"chat",params:{userId:e.offer.author}})}}},[e._v(" Chat with creator ")])]):e._e(),r("br"),e.offer.closed?r("div",[e._v(" Already bought ")]):e._e(),e.canEdit?r("div",[r("button",{on:{click:function(t){return e.navigateTo({name:"offer-edit",params:{offerId:e.offer._id}})}}},[e._v(" Edit Offer ")])]):e._e(),e.canBuy?r("div",[r("button",{on:{click:e.buy}},[e._v(" Buy Offer ")])]):e._e(),e.canStartBidding?r("div",[r("button",{on:{click:e.startBid}},[e._v(" Start Bidding ")])]):e._e(),e.canFinishBidding?r("div",[r("button",{on:{click:e.finishBid}},[e._v(" Finish Bidding ")])]):e._e(),e.canEnterBidding?r("div",[r("bidding",{attrs:{offerId:e.offer._id}})],1):e._e()])},q=[],K=function(){var e=this,t=e.$createElement,r=e._self._c||t;return r("div",{staticClass:"mid-app"},[r("div",[r("h3",[e._v(" Current price: "+e._s(e.offer.price)+" USD")]),r("hr")]),r("div",[r("table",{staticClass:"mid-table"},e._l(e.bids,(function(t,n){return r("tr",{key:n},[r("td",[e._v(e._s(t.bidderName)+": ")]),r("td",[e._v(" "+e._s(t.price)+" ")])])})),0)]),r("div",[r("form",{on:{submit:function(t){return t.preventDefault(),e.sendMessage(t)}}},[r("div",[r("label",{attrs:{for:"price"}},[e._v("Your Bid:")]),r("input",{directives:[{name:"model",rawName:"v-model",value:e.price,expression:"price"}],attrs:{type:"number"},domProps:{value:e.price},on:{input:function(t){t.target.composing||(e.price=t.target.value)}}})]),r("button",{staticClass:"btn btn-success",attrs:{disabled:2!==e.offer.biddingStatus,type:"submit"}},[e._v("Send")])])])])},Q=[],W=r("8055"),X=r.n(W),ee={data:function(){return{offer:{},price:"",bids:[],socket:null}},methods:{sendMessage:function(){var e=this;return Object(w["a"])(regeneratorRuntime.mark((function t(){var r;return regeneratorRuntime.wrap((function(t){while(1)switch(t.prev=t.next){case 0:if(!(e.price>e.offer.price)){t.next=16;break}return t.prev=1,t.next=4,N.bid({offerId:e.offer._id,price:e.price});case 4:return e.socket.emit("SEND_BID",{bidderId:e.$store.state.user._id,bidderName:e.$store.state.user.username,price:e.price,offerId:e.offer._id}),console.log("bid made"),t.next=8,N.show(e.offer._id);case 8:r=t.sent.data,e.offer=r,e.price="",t.next=16;break;case 13:t.prev=13,t.t0=t["catch"](1),console.log(t.t0);case 16:case"end":return t.stop()}}),t,null,[[1,13]])})))()}},mounted:function(){var e=this;return Object(w["a"])(regeneratorRuntime.mark((function t(){var r,n;return regeneratorRuntime.wrap((function(t){while(1)switch(t.prev=t.next){case 0:if(e.$store.state.isUserLoggedIn){t.next=4;break}e.$router.push({name:"offers"}),t.next=20;break;case 4:return t.prev=4,e.socket=X()("wss://".concat(window.location.host)),r=e.$store.state.route.params.offerId,t.next=9,N.indexBids(r);case 9:return n=t.sent.data,e.bids=n,t.next=13,N.show(r);case 13:e.offer=t.sent.data,e.socket.on("BID",(function(t){console.log("bid received: "),console.log(t),console.log("this offer: "),console.log(e.offer),t.offerId===e.offer._id&&(e.bids.push(t),e.offer.price=t.price)})),t.next=20;break;case 17:t.prev=17,t.t0=t["catch"](4),console.log(t.t0);case 20:case"end":return t.stop()}}),t,null,[[4,17]])})))()}},te=ee,re=(r("1783"),Object(f["a"])(te,K,Q,!1,null,"3ecd4d74",null)),ne=re.exports,se={components:{Bidding:ne},data:function(){return{offer:{},author:"",canBuy:!1,canEdit:!1,canStartBidding:!1,canFinishBidding:!1,canEnterBidding:!1}},methods:{navigateTo:function(e){this.$router.push(e)},buy:function(){var e=this;return Object(w["a"])(regeneratorRuntime.mark((function t(){return regeneratorRuntime.wrap((function(t){while(1)switch(t.prev=t.next){case 0:return t.prev=0,t.next=3,N.buy(e.offer);case 3:e.offer.closed=!0,e.canBuy=!1,t.next=10;break;case 7:t.prev=7,t.t0=t["catch"](0),console.log(t.t0);case 10:case"end":return t.stop()}}),t,null,[[0,7]])})))()},startBid:function(){var e=this;return Object(w["a"])(regeneratorRuntime.mark((function t(){var r;return regeneratorRuntime.wrap((function(t){while(1)switch(t.prev=t.next){case 0:return t.prev=0,t.next=3,N.start(e.offer);case 3:r=t.sent.data,e.offer=r,e.canStartBidding=!1,e.canFinishBidding=!0,t.next=12;break;case 9:t.prev=9,t.t0=t["catch"](0),console.log(t.t0);case 12:case"end":return t.stop()}}),t,null,[[0,9]])})))()},finishBid:function(){var e=this;return Object(w["a"])(regeneratorRuntime.mark((function t(){var r;return regeneratorRuntime.wrap((function(t){while(1)switch(t.prev=t.next){case 0:return t.prev=0,t.next=3,N.finish(e.offer);case 3:r=t.sent.data,e.offer=r,e.canFinishBidding=!1,t.next=11;break;case 8:t.prev=8,t.t0=t["catch"](0),console.log(t.t0);case 11:case"end":return t.stop()}}),t,null,[[0,8]])})))()},isAuthor:function(e){return this.$store.state.isUserLoggedIn&&e.author===this.$store.state.user._id},isLoggedIn:function(){return this.$store.state.isUserLoggedIn}},mounted:function(){var e=this;return Object(w["a"])(regeneratorRuntime.mark((function t(){var r;return regeneratorRuntime.wrap((function(t){while(1)switch(t.prev=t.next){case 0:return r=e.$store.state.route.params.offerId,t.next=3,N.show(r);case 3:return e.offer=t.sent.data,console.log(e.offer),t.next=7,$.show(e.offer.author);case 7:e.author=t.sent.data,e.$store.state.isUserLoggedIn&&(e.offer.author!==e.$store.state.user._id||e.offer.closed||1!==e.offer.biddingStatus?(console.log("cant edit"),e.canEdit=!1):(console.log("can edit"),e.canEdit=!0),e.offer.author!==e.$store.state.user._id||e.offer.closed||!0!==e.offer.bidding||(1===e.offer.biddingStatus&&(e.canStartBidding=!0),2===e.offer.biddingStatus&&(e.canFinishBidding=!0)),e.offer.author===e.$store.state.user._id||e.offer.closed||!0!==e.offer.bidding||2!==e.offer.biddingStatus||(e.canEnterBidding=!0),e.offer.author===e.$store.state.user._id||e.offer.closed||!1!==e.offer.bidding?(console.log("cant buy"),e.canBuy=!1):(console.log("can buy"),e.canBuy=!0),console.log("can edit: "+e.canEdit),console.log("can buy: "+e.canBuy));case 9:case"end":return t.stop()}}),t)})))()}},ie=se,ae=(r("c943"),Object(f["a"])(ie,Z,q,!1,null,"6e120427",null)),oe=ae.exports,ce=function(){var e=this,t=e.$createElement,r=e._self._c||t;return r("div",{staticClass:"offer-create"},[e._v(" Edit offer "),r("br"),r("input",{directives:[{name:"model",rawName:"v-model",value:e.offer.title,expression:"offer.title"}],attrs:{type:"text",name:"title",placeholder:"Title"},domProps:{value:e.offer.title},on:{input:function(t){t.target.composing||e.$set(e.offer,"title",t.target.value)}}}),r("br"),e._v(" Allow bidding "),r("input",{directives:[{name:"model",rawName:"v-model",value:e.offer.bidding,expression:"offer.bidding"}],attrs:{type:"checkbox",name:"bidding",placeholder:"Bidding"},domProps:{checked:Array.isArray(e.offer.bidding)?e._i(e.offer.bidding,null)>-1:e.offer.bidding},on:{change:function(t){var r=e.offer.bidding,n=t.target,s=!!n.checked;if(Array.isArray(r)){var i=null,a=e._i(r,i);n.checked?a<0&&e.$set(e.offer,"bidding",r.concat([i])):a>-1&&e.$set(e.offer,"bidding",r.slice(0,a).concat(r.slice(a+1)))}else e.$set(e.offer,"bidding",s)}}}),r("br"),r("input",{directives:[{name:"model",rawName:"v-model",value:e.offer.price,expression:"offer.price"}],attrs:{type:"number",name:"price",placeholder:"Price"},domProps:{value:e.offer.price},on:{input:function(t){t.target.composing||e.$set(e.offer,"price",t.target.value)}}}),r("br"),r("button",{on:{click:e.save}},[e._v("Save Offer")])])},ue=[],fe={data:function(){return{offer:{}}},methods:{save:function(){var e=this;return Object(w["a"])(regeneratorRuntime.mark((function t(){var r;return regeneratorRuntime.wrap((function(t){while(1)switch(t.prev=t.next){case 0:if(e.offer.author!==e.$store.state.user._id){t.next=14;break}return t.prev=1,r=e.$store.state.route.params.offerId,console.log("offerId => "+r),t.next=6,N.put(e.offer);case 6:e.$router.push({name:"offer",params:{offerId:r}}),t.next=12;break;case 9:t.prev=9,t.t0=t["catch"](1),console.log(t.t0);case 12:t.next=16;break;case 14:console.log("tylko autor moze editowac"),console.log(e.offer.author+" != "+e.$store.state.user._id);case 16:case"end":return t.stop()}}),t,null,[[1,9]])})))()}},mounted:function(){var e=this;return Object(w["a"])(regeneratorRuntime.mark((function t(){var r;return regeneratorRuntime.wrap((function(t){while(1)switch(t.prev=t.next){case 0:if(e.$store.state.isUserLoggedIn){t.next=4;break}e.$router.push({name:"offers"}),t.next=15;break;case 4:return t.prev=4,r=e.$store.state.route.params.offerId,t.next=8,N.show(r);case 8:e.offer=t.sent.data,console.log(e.offer),t.next=15;break;case 12:t.prev=12,t.t0=t["catch"](4),console.log(t.t0);case 15:case"end":return t.stop()}}),t,null,[[4,12]])})))()}},de=fe,le=(r("f97f"),Object(f["a"])(de,ce,ue,!1,null,"473810f7",null)),pe=le.exports,ge=function(){var e=this,t=e.$createElement,r=e._self._c||t;return r("div",{staticClass:"main-app"},[r("div",{staticClass:"cstGrid"},e._l(e.visibleOffers,(function(t){return r("div",{key:t.id,staticClass:"cstGridField"},[e._v(" "+e._s(e.isAuthor(t)?"AUTHOR":"")+" "+e._s(!e.isAuthor(t)&&t.closed?"CLOSED":"")+" "+e._s(e.isAuthor(t)||t.closed?"":"OPEN")+" "),r("br"),e._v(" "+e._s(t.title)+" "),r("br"),e._v(" "+e._s(t.price)+" "),r("br"),e._v(" "+e._s(e.getOption(t))+" "),r("br"),r("button",{on:{click:function(r){return e.navigateTo({name:"offer",params:{offerId:t._id}})}}},[e._v(" View Offer ")])])})),0),e.totalPages()>0?r("div",{staticClass:"pagination"},[e.showPreviousLink()?r("span",{staticClass:"pagination-btn",on:{click:function(t){return e.updatePage(e.currentPage-1)}}},[e._v(" < ")]):e._e(),e._v(" "+e._s(e.currentPage+1)+" of "+e._s(e.totalPages())+" "),e.showNextLink()?r("span",{staticClass:"pagination-btn",on:{click:function(t){return e.updatePage(e.currentPage+1)}}},[e._v(" > ")]):e._e()]):e._e()])},he=[],ve={data:function(){return{offers:{},visibleOffers:{},currentPage:0,pageSize:5}},methods:{navigateTo:function(e){this.$router.push(e)},updateVisibleOffers:function(){this.visibleOffers=this.offers.slice(this.currentPage*this.pageSize,this.currentPage*this.pageSize+this.pageSize),0===this.visibleOffers.length&&this.currentPage>0&&this.updatePage(this.currentPage-1)},updatePage:function(e){this.currentPage=e,this.updateVisibleOffers()},totalPages:function(){return Math.ceil(this.offers.length/this.pageSize)},showPreviousLink:function(){return 0!==this.currentPage},showNextLink:function(){return this.currentPage!==this.totalPages()-1},isAuthor:function(e){return this.$store.state.isUserLoggedIn&&e.author===this.$store.state.user._id},getOption:function(e){return e.bidding&&1===e.biddingStatus?"Bidding not started":e.bidding||e.closed?e.closed?"Bought":e.bidding&&2===e.biddingStatus?"Bidding in progress":void 0:"Buy now"}},mounted:function(){var e=this;return Object(w["a"])(regeneratorRuntime.mark((function t(){return regeneratorRuntime.wrap((function(t){while(1)switch(t.prev=t.next){case 0:if(e.$store.state.isUserLoggedIn){t.next=4;break}e.$router.push({name:"offers"}),t.next=9;break;case 4:return t.next=6,N.history();case 6:e.offers=t.sent.data,console.log(e.offers),e.updateVisibleOffers();case 9:case"end":return t.stop()}}),t)})))()}},me=ve,be=(r("24a7"),Object(f["a"])(me,ge,he,!1,null,"2727befc",null)),_e=be.exports,we=function(){var e=this,t=e.$createElement,r=e._self._c||t;return r("div",{staticClass:"main-app"},[r("div",{staticClass:"cstGrid"},e._l(e.visibleOffers,(function(t){return r("div",{key:t.id,staticClass:"cstGridField"},[e._v(" "+e._s(e.isAuthor(t)?"AUTHOR":"")+" "+e._s(!e.isAuthor(t)&&t.closed?"CLOSED":"")+" "+e._s(e.isAuthor(t)||t.closed?"":"OPEN")+" "),r("br"),e._v(" "+e._s(t.title)+" "),r("br"),e._v(" "+e._s(t.price)+" "),r("br"),e._v(" "+e._s(e.getOption(t))+" "),r("br"),r("button",{staticClass:"cstButton",on:{click:function(r){return e.navigateTo({name:"offer",params:{offerId:t._id}})}}},[e._v(" View Offer ")]),r("br"),r("input",{directives:[{name:"model",rawName:"v-model",value:e.price,expression:"price"}],staticClass:"cstInput",attrs:{type:"number",name:"price",placeholder:"price"},domProps:{value:e.price},on:{input:function(t){t.target.composing||(e.price=t.target.value)}}}),r("button",{staticClass:"cstButton",on:{click:function(r){return e.dynamicBid(t)}}},[e._v(" Bid ")])])})),0),e.totalPages()>0?r("div",{staticClass:"pagination"},[e.showPreviousLink()?r("span",{staticClass:"pagination-btn",on:{click:function(t){return e.updatePage(e.currentPage-1)}}},[e._v(" < ")]):e._e(),e._v(" "+e._s(e.currentPage+1)+" of "+e._s(e.totalPages())+" "),e.showNextLink()?r("span",{staticClass:"pagination-btn",on:{click:function(t){return e.updatePage(e.currentPage+1)}}},[e._v(" > ")]):e._e()]):e._e()])},xe=[],ke={data:function(){return{offers:{},visibleOffers:{},price:0,currentPage:0,pageSize:5,socket:X()("wss://localhost:8081")}},methods:{navigateTo:function(e){this.$router.push(e)},updateVisibleOffers:function(){this.visibleOffers=this.offers.slice(this.currentPage*this.pageSize,this.currentPage*this.pageSize+this.pageSize),0===this.visibleOffers.length&&this.currentPage>0&&this.updatePage(this.currentPage-1)},updatePage:function(e){this.currentPage=e,this.updateVisibleOffers()},totalPages:function(){return Math.ceil(this.offers.length/this.pageSize)},showPreviousLink:function(){return 0!==this.currentPage},showNextLink:function(){return this.currentPage!==this.totalPages()-1},isAuthor:function(e){return this.$store.state.isUserLoggedIn&&e.author===this.$store.state.user._id},getOption:function(e){return e.bidding&&1===e.biddingStatus?"Bidding not started":e.bidding||e.closed?e.closed?"Bought":e.bidding&&2===e.biddingStatus?"Bidding in progress":void 0:"Buy now"},dynamicBid:function(e){var t=this;return Object(w["a"])(regeneratorRuntime.mark((function r(){return regeneratorRuntime.wrap((function(r){while(1)switch(r.prev=r.next){case 0:if(!(t.price>e.price)){r.next=14;break}return r.prev=1,r.next=4,N.bid({offerId:e._id,price:t.price});case 4:return t.socket.emit("SEND_BID",{bidderId:t.$store.state.user._id,bidderName:t.$store.state.user.username,price:t.price,offerId:e._id}),r.next=7,N.historyBidding();case 7:t.offers=r.sent.data,t.updateVisibleOffers(),r.next=14;break;case 11:r.prev=11,r.t0=r["catch"](1),console.log(r.t0);case 14:case"end":return r.stop()}}),r,null,[[1,11]])})))()}},mounted:function(){var e=this;return Object(w["a"])(regeneratorRuntime.mark((function t(){return regeneratorRuntime.wrap((function(t){while(1)switch(t.prev=t.next){case 0:if(e.$store.state.isUserLoggedIn){t.next=4;break}e.$router.push({name:"offers"}),t.next=8;break;case 4:return t.next=6,N.historyBidding();case 6:e.offers=t.sent.data,e.updateVisibleOffers();case 8:case"end":return t.stop()}}),t)})))()}},Pe=ke,$e=(r("4ed5"),Object(f["a"])(Pe,we,xe,!1,null,"c8f0088a",null)),Oe=$e.exports,ye=function(){var e=this,t=e.$createElement,r=e._self._c||t;return r("div",{staticClass:"main-app"},[r("div",{staticClass:"cstGrid"},e._l(e.visibleUsers,(function(t){return r("div",{key:t.id,staticClass:"cstGridField"},[e._v(" "+e._s(t.username)+" "),r("br"),r("button",{staticClass:"cstButton",on:{click:function(r){return e.navigateTo({name:"chat",params:{userId:t._id}})}}},[e._v(" View Chat ")])])})),0),e.totalPages()>0?r("div",{staticClass:"pagination"},[e.showPreviousLink()?r("span",{staticClass:"pagination-btn",on:{click:function(t){return e.updatePage(e.currentPage-1)}}},[e._v(" < ")]):e._e(),e._v(" "+e._s(e.currentPage+1)+" of "+e._s(e.totalPages())+" "),e.showNextLink()?r("span",{staticClass:"pagination-btn",on:{click:function(t){return e.updatePage(e.currentPage+1)}}},[e._v(" > ")]):e._e()]):e._e()])},Ie=[],Ce={index:function(){return P().get("chats")},show:function(e){return P().get("chats/".concat(e))},post:function(e){return P().post("chats",e)},getNotes:function(){return P().get("notes")}},Be={data:function(){return{users:{},visibleUsers:{},currentPage:0,pageSize:5}},methods:{navigateTo:function(e){this.$router.push(e)},updateVisibleUsers:function(){this.visibleUsers=this.users.slice(this.currentPage*this.pageSize,this.currentPage*this.pageSize+this.pageSize),0===this.visibleUsers.length&&this.currentPage>0&&this.updatePage(this.currentPage-1)},updatePage:function(e){this.currentPage=e,this.updateVisibleUsers()},totalPages:function(){return Math.ceil(this.users.length/this.pageSize)},showPreviousLink:function(){return 0!==this.currentPage},showNextLink:function(){return this.currentPage!==this.totalPages()-1}},mounted:function(){var e=this;return Object(w["a"])(regeneratorRuntime.mark((function t(){return regeneratorRuntime.wrap((function(t){while(1)switch(t.prev=t.next){case 0:if(e.$store.state.isUserLoggedIn){t.next=4;break}e.$router.push({name:"offers"}),t.next=8;break;case 4:return t.next=6,Ce.index();case 6:e.users=t.sent.data,e.updateVisibleUsers();case 8:case"end":return t.stop()}}),t)})))()}},Se=Be,Le=(r("867b"),Object(f["a"])(Se,ye,Ie,!1,null,"11c6ff99",null)),Ue=Le.exports,Ee=function(){var e=this,t=e.$createElement,r=e._self._c||t;return r("div",{staticClass:"mid-app"},[r("div",[r("h3",[e._v("Chat with user: "+e._s(e.receiver.username))]),r("hr"),r("table",{staticClass:"main-table",attrs:{id:"chatbox"}},e._l(e.messages,(function(t,n){return r("tr",{key:n},[r("td",[e._v(" "+e._s(e.formatDate(new Date(t.createdAt)))+", ")]),r("td",[e._v(e._s(t.senderId===e.currentUserId?e.currentUserUserName:e.receiver.username)+": ")]),r("td",[e._v(" "+e._s(t.text)+" ")])])})),0)]),r("div",[r("form",{on:{submit:function(t){return t.preventDefault(),e.sendMessage(t)}}},[r("div",[r("input",{directives:[{name:"model",rawName:"v-model",value:e.message,expression:"message"}],attrs:{type:"text"},domProps:{value:e.message},on:{input:function(t){t.target.composing||(e.message=t.target.value)}}})]),r("button",{staticClass:"cstInput",attrs:{type:"submit"}},[e._v("Send")])])])])},Re=[],je={data:function(){return{receiver:{},currentUserId:"",currentUserUserName:"",message:"",messages:[],socket:null}},methods:{sendMessage:function(){var e=this;return Object(w["a"])(regeneratorRuntime.mark((function t(){var r,n;return regeneratorRuntime.wrap((function(t){while(1)switch(t.prev=t.next){case 0:if(!(e.message.length>0)){t.next=16;break}return t.prev=1,r=new Date,t.next=5,Ce.post({senderId:e.$store.state.user._id,receiverId:e.receiver._id,text:e.message,createdAt:r});case 5:return e.socket.emit("SEND_MESSAGE",{senderId:e.$store.state.user._id,receiverId:e.receiver._id,text:e.message,createdAt:r}),t.next=8,Ce.show(e.receiver._id);case 8:n=t.sent.data,e.messages=n,e.message="",t.next=16;break;case 13:t.prev=13,t.t0=t["catch"](1),console.log(t.t0);case 16:case"end":return t.stop()}}),t,null,[[1,13]])})))()},formatDate:function(e){return e.getDate()+"/"+e.getMonth()+"/"+e.getFullYear()+" - "+e.getHours()+":"+e.getMinutes()+":"+e.getSeconds()}},mounted:function(){var e=this;return Object(w["a"])(regeneratorRuntime.mark((function t(){var r,n;return regeneratorRuntime.wrap((function(t){while(1)switch(t.prev=t.next){case 0:if(e.$store.state.isUserLoggedIn){t.next=4;break}e.$router.push({name:"offers"}),t.next=23;break;case 4:return t.prev=4,e.socket=X()("wss://".concat(window.location.host)),r=e.$store.state.route.params.userId,t.next=9,$.show(r);case 9:return n=t.sent.data,e.receiver=n,e.receiverId=n._id,e.currentUserId=e.$store.state.user._id,e.currentUserUserName=e.$store.state.user.username,t.next=16,Ce.show(r);case 16:e.messages=t.sent.data,e.socket.on("MESSAGE",(function(t){console.log("got message"),console.log("if (("+t.receiverId+"==="+e.receiverId+"&&"+t.senderId+"==="+e.$store.state.user._id+") || ("+t.receiverId+"==="+e.$store.state.user._id+"&&"+t.senderId+"==="+e.receiverId+"))"),(t.receiverId===e.receiverId&&t.senderId===e.$store.state.user._id||t.receiverId===e.$store.state.user._id&&t.senderId===e.receiverId)&&(console.log("validated message"),e.messages.push(t))})),t.next=23;break;case 20:t.prev=20,t.t0=t["catch"](4),console.log(t.t0);case 23:case"end":return t.stop()}}),t,null,[[4,20]])})))()}},Ae=je,Ne=(r("53a9"),Object(f["a"])(Ae,Ee,Re,!1,null,"6407c7e8",null)),Te=Ne.exports,ze=function(){var e=this,t=e.$createElement,r=e._self._c||t;return r("div",{staticClass:"noteBox"},[r("p",{staticClass:"noteBoxText"},[e._v("You have "+e._s(e.notes.length)+" new notifications!")]),e._l(e.notes,(function(t){return r("div",{key:t.id,staticClass:"noteBoxText"},[e._v(" "+e._s(t.senderUserName)+" has sent you new message! Check your chats ")])}))],2)},De=[],Me={data:function(){return{notes:{}}},mounted:function(){var e=this;return Object(w["a"])(regeneratorRuntime.mark((function t(){return regeneratorRuntime.wrap((function(t){while(1)switch(t.prev=t.next){case 0:return t.next=2,Ce.getNotes();case 2:e.notes=t.sent.data,0===e.notes.length&&e.$router.push({name:"offers"});case 4:case"end":return t.stop()}}),t)})))()}},Ve=Me,Fe=(r("ec51"),Object(f["a"])(Ve,ze,De,!1,null,"301e9656",null)),Ge=Fe.exports;n["a"].use(m["a"]);var He=new m["a"]({routes:[{path:"/register",name:"register",component:C},{path:"/login",name:"login",component:R},{path:"/offers",name:"offers",component:M},{path:"/offers/create",name:"offers-create",component:J},{path:"/offers/:offerId",name:"offer",component:oe},{path:"/offers/:offerId/edit",name:"offer-edit",component:pe},{path:"/offers/:offerId/bidding",name:"offer-bidding",component:ne},{path:"/history",name:"history",component:_e},{path:"/historyBidding",name:"history-bidding",component:Oe},{path:"/chats",name:"chats",component:Ue},{path:"/chats/:userId",name:"chat",component:Te},{path:"/notifications",name:"notifications",component:Ge},{path:"*",redirect:"offers"}]}),Ye=r("31bd"),Je=r("2f62"),Ze=r("0e44");n["a"].use(Je["a"]);var qe=new Je["a"].Store({strict:!0,plugins:[Object(Ze["a"])({storage:window.sessionStorage})],state:{token:null,user:null,isUserLoggedIn:!1},mutations:{login:function(e,t){e.user=t,e.isUserLoggedIn=!0},logout:function(e){sessionStorage.clear(),e.user=null,e.isUserLoggedIn=!1},setToken:function(e,t){e.token=t,e.isUserLoggedIn=!!t},setUser:function(e,t){e.user=t}},actions:{setToken:function(e,t){var r=e.commit;r("setToken",t)},setUser:function(e,t){var r=e.commit;r("setUser",t)}}}),Ke=r("2b27"),Qe=r.n(Ke);n["a"].config.productionTip=!1,n["a"].use(Qe.a),Object(Ye["sync"])(qe,He),new n["a"]({el:"#app",router:He,store:qe,components:{App:v},template:"<App/>"})},"789d":function(e,t,r){"use strict";var n=r("b75f"),s=r.n(n);s.a},8474:function(e,t,r){},"867b":function(e,t,r){"use strict";var n=r("fb1e"),s=r.n(n);s.a},"960f":function(e,t,r){},9816:function(e,t,r){},a797:function(e,t,r){"use strict";var n=r("9816"),s=r.n(n);s.a},b75f:function(e,t,r){},b8a8:function(e,t,r){},c943:function(e,t,r){"use strict";var n=r("960f"),s=r.n(n);s.a},d8da:function(e,t,r){},dceb:function(e,t,r){},ec51:function(e,t,r){"use strict";var n=r("38ea"),s=r.n(n);s.a},f97f:function(e,t,r){"use strict";var n=r("03de"),s=r.n(n);s.a},fb1e:function(e,t,r){}});
//# sourceMappingURL=app.4d53cea0.js.map