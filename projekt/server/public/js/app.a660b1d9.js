(function(e){function t(t){for(var n,a,o=t[0],c=t[1],u=t[2],d=0,l=[];d<o.length;d++)a=o[d],Object.prototype.hasOwnProperty.call(s,a)&&s[a]&&l.push(s[a][0]),s[a]=0;for(n in c)Object.prototype.hasOwnProperty.call(c,n)&&(e[n]=c[n]);f&&f(t);while(l.length)l.shift()();return i.push.apply(i,u||[]),r()}function r(){for(var e,t=0;t<i.length;t++){for(var r=i[t],n=!0,o=1;o<r.length;o++){var c=r[o];0!==s[c]&&(n=!1)}n&&(i.splice(t--,1),e=a(a.s=r[0]))}return e}var n={},s={app:0},i=[];function a(t){if(n[t])return n[t].exports;var r=n[t]={i:t,l:!1,exports:{}};return e[t].call(r.exports,r,r.exports,a),r.l=!0,r.exports}a.m=e,a.c=n,a.d=function(e,t,r){a.o(e,t)||Object.defineProperty(e,t,{enumerable:!0,get:r})},a.r=function(e){"undefined"!==typeof Symbol&&Symbol.toStringTag&&Object.defineProperty(e,Symbol.toStringTag,{value:"Module"}),Object.defineProperty(e,"__esModule",{value:!0})},a.t=function(e,t){if(1&t&&(e=a(e)),8&t)return e;if(4&t&&"object"===typeof e&&e&&e.__esModule)return e;var r=Object.create(null);if(a.r(r),Object.defineProperty(r,"default",{enumerable:!0,value:e}),2&t&&"string"!=typeof e)for(var n in e)a.d(r,n,function(t){return e[t]}.bind(null,n));return r},a.n=function(e){var t=e&&e.__esModule?function(){return e["default"]}:function(){return e};return a.d(t,"a",t),t},a.o=function(e,t){return Object.prototype.hasOwnProperty.call(e,t)},a.p="/";var o=window["webpackJsonp"]=window["webpackJsonp"]||[],c=o.push.bind(o);o.push=t,o=o.slice();for(var u=0;u<o.length;u++)t(o[u]);var f=c;i.push([0,"chunk-vendors"]),r()})({0:function(e,t,r){e.exports=r("56d7")},"01be":function(e,t,r){},"04f1":function(e,t,r){"use strict";var n=r("6fe9"),s=r.n(n);s.a},1:function(e,t){},1290:function(e,t,r){},"19fc":function(e,t,r){"use strict";var n=r("d694"),s=r.n(n);s.a},"2d5e":function(e,t,r){},"38ea":function(e,t,r){},"3f4c":function(e,t,r){"use strict";var n=r("5483"),s=r.n(n);s.a},"522d":function(e,t,r){},"52af":function(e,t,r){"use strict";var n=r("01be"),s=r.n(n);s.a},5483:function(e,t,r){},"56d7":function(e,t,r){"use strict";r.r(t);r("e260"),r("e6cf"),r("cca6"),r("a79d");var n=r("a026"),s=function(){var e=this,t=e.$createElement,r=e._self._c||t;return r("div",{attrs:{id:"main-app"}},[r("page-header"),r("router-view")],1)},i=[],a=function(){var e=this,t=e.$createElement,r=e._self._c||t;return r("div",{staticClass:"navBar"},[r("nav",[e.$store.state.isUserLoggedIn?e._e():r("router-link",{staticClass:"navElem",attrs:{to:"/login"}},[e._v("Login")]),e.$store.state.isUserLoggedIn?e._e():r("router-link",{staticClass:"navElem",attrs:{to:"/register"}},[e._v("Register")]),e.$store.state.isUserLoggedIn?r("router-link",{staticClass:"navElem",attrs:{to:"/historyBidding"}},[e._v("Active-Biddings")]):e._e(),e.$store.state.isUserLoggedIn?r("router-link",{staticClass:"navElem",attrs:{to:"/history"}},[e._v("History")]):e._e(),e.$store.state.isUserLoggedIn?r("router-link",{staticClass:"navElem",attrs:{to:"/chats"}},[e._v("Chats")]):e._e(),r("router-link",{staticClass:"navElem",attrs:{to:"/offers"}},[e._v("Offers")]),e.$store.state.isUserLoggedIn?r("button",{staticClass:"navButton",on:{click:e.logout}},[e._v("Log Out")]):e._e()],1),e.$store.state.isUserLoggedIn?r("div",{staticClass:"userData"},[e._v(" Zalogowany: "+e._s(e.$store.state.user.username)+" ")]):e._e()])},o=[],c={methods:{logout:function(){this.$store.dispatch("setToken",null),this.$store.dispatch("setUser",null),this.$router.push({name:"offers"})}}},u=c,f=(r("6ab1"),r("2877")),d=Object(f["a"])(u,a,o,!1,null,"597e5218",null),l=d.exports,p={name:"App",components:{PageHeader:l}},g=p,h=Object(f["a"])(g,s,i,!1,null,null,null),v=h.exports,m=r("8c4f"),b=function(){var e=this,t=e.$createElement,r=e._self._c||t;return r("div",{staticClass:"main-app"},[r("h1",[e._v("Register")]),r("input",{directives:[{name:"model",rawName:"v-model",value:e.username,expression:"username"}],attrs:{type:"text",name:"username",placeholder:"username"},domProps:{value:e.username},on:{input:function(t){t.target.composing||(e.username=t.target.value)}}}),r("br"),r("input",{directives:[{name:"model",rawName:"v-model",value:e.password,expression:"password"}],attrs:{type:"password",name:"password",placeholder:"password"},domProps:{value:e.password},on:{input:function(t){t.target.composing||(e.password=t.target.value)}}}),r("br"),r("div",{domProps:{innerHTML:e._s(e.error)}}),r("button",{on:{click:e.register}},[e._v("Register")])])},_=[],w=(r("96cf"),r("1da1")),x=r("bc3a"),k=r.n(x),P=function(){return k.a.create({baseURL:"https://"+window.location.hostname,withCredentials:!0})},$={register:function(e){return P().post("register",e)},login:function(e){return P().post("login",e)},show:function(e){return P().get("user/".concat(e))}},O={data:function(){return{username:"",password:"",error:""}},methods:{register:function(){var e=this;return Object(w["a"])(regeneratorRuntime.mark((function t(){var r;return regeneratorRuntime.wrap((function(t){while(1)switch(t.prev=t.next){case 0:return t.prev=0,t.next=3,$.register({username:e.username,password:e.password});case 3:r=t.sent,console.log(r),e.$router.push({name:"offers"}),t.next=11;break;case 8:t.prev=8,t.t0=t["catch"](0),e.error=t.t0.response.data.error;case 11:case"end":return t.stop()}}),t,null,[[0,8]])})))()}},mounted:function(){this.$store.state.isUserLoggedIn&&this.$router.push({name:"offers"})}},y=O,I=(r("8137"),Object(f["a"])(y,b,_,!1,null,"32391199",null)),B=I.exports,S=function(){var e=this,t=e.$createElement,r=e._self._c||t;return r("div",{staticClass:"main-app"},[r("h1",[e._v("Login")]),r("input",{directives:[{name:"model",rawName:"v-model",value:e.username,expression:"username"}],attrs:{type:"text",name:"username",placeholder:"username"},domProps:{value:e.username},on:{input:function(t){t.target.composing||(e.username=t.target.value)}}}),r("br"),r("input",{directives:[{name:"model",rawName:"v-model",value:e.password,expression:"password"}],attrs:{type:"password",name:"password",placeholder:"password"},domProps:{value:e.password},on:{input:function(t){t.target.composing||(e.password=t.target.value)}}}),r("br"),r("div",{domProps:{innerHTML:e._s(e.error)}}),r("button",{on:{click:e.login}},[e._v("Login")])])},C=[],L={data:function(){return{username:"",password:"",error:""}},methods:{login:function(){var e=this;return Object(w["a"])(regeneratorRuntime.mark((function t(){var r;return regeneratorRuntime.wrap((function(t){while(1)switch(t.prev=t.next){case 0:return t.prev=0,t.next=3,$.login({username:e.username,password:e.password});case 3:r=t.sent,console.log(r.data),e.$store.commit("login",r.data.user),e.$router.push({name:"notifications"}),t.next=12;break;case 9:t.prev=9,t.t0=t["catch"](0),e.error=t.t0.response.data.error;case 12:case"end":return t.stop()}}),t,null,[[0,9]])})))()}},mounted:function(){this.$store.state.isUserLoggedIn&&this.$router.push({name:"notifications"})}},U=L,E=(r("b4d2"),Object(f["a"])(U,S,C,!1,null,"33880ebf",null)),R=E.exports,j=function(){var e=this,t=e.$createElement,r=e._self._c||t;return r("div",{staticClass:"main-app"},[e.canCreateOffer()?r("div",[r("button",{staticClass:"createBtn",on:{click:function(t){return e.navigateTo({name:"offers-create"})}}},[e._v("Create Offer ")])]):e._e(),r("table",{staticClass:"cstTable"},[e._m(0),e._l(e.visibleOffers,(function(t){return r("tr",{key:t.id},[r("td",[e._v(" "+e._s(e.isAuthor(t)?"AUTHOR":"")+" "+e._s(!e.isAuthor(t)&&t.closed?"CLOSED":"")+" "+e._s(e.isAuthor(t)||t.closed?"":"OPEN")+" ")]),r("td",[e._v(e._s(t.title))]),r("td",[e._v(e._s(t.price))]),r("td",[e._v(e._s(e.getOption(t)))]),r("td",[r("button",{on:{click:function(r){return e.navigateTo({name:"offer",params:{offerId:t._id}})}}},[e._v(" View Offer ")])])])}))],2),e.totalPages()>0?r("div",{staticClass:"pagination"},[e.showPreviousLink()?r("span",{staticClass:"pagination-btn",on:{click:function(t){return e.updatePage(e.currentPage-1)}}},[e._v(" < ")]):e._e(),e._v(" "+e._s(e.currentPage+1)+" of "+e._s(e.totalPages())+" "),e.showNextLink()?r("span",{staticClass:"pagination-btn",on:{click:function(t){return e.updatePage(e.currentPage+1)}}},[e._v(" > ")]):e._e()]):e._e()])},T=[function(){var e=this,t=e.$createElement,r=e._self._c||t;return r("tr",[r("th",[e._v("Status")]),r("th",[e._v("Title")]),r("th",[e._v("Price")]),r("th",[e._v("Option")]),r("th",[e._v("Details")])])}],N=(r("fb6a"),{index:function(){return P().get("offers")},history:function(){return P().get("history")},historyBidding:function(){return P().get("historyBidding")},post:function(e){return P().post("offers",e)},show:function(e){return P().get("offers/".concat(e))},put:function(e){return P().put("offers/".concat(e._id),e)},buy:function(e){return P().put("offers/".concat(e._id,"/buy"),e)},start:function(e){return P().put("offers/".concat(e._id,"/start"),e)},finish:function(e){return P().put("offers/".concat(e._id,"/finish"),e)},bid:function(e){return P().put("offers/".concat(e.offerId,"/bid"),{price:e.price})},indexBids:function(e){return P().get("offers/".concat(e,"/bids"))}}),A={data:function(){return{offers:{},visibleOffers:{},currentPage:0,pageSize:5}},methods:{navigateTo:function(e){this.$router.push(e)},updateVisibleOffers:function(){this.visibleOffers=this.offers.slice(this.currentPage*this.pageSize,this.currentPage*this.pageSize+this.pageSize),0===this.visibleOffers.length&&this.currentPage>0&&this.updatePage(this.currentPage-1)},updatePage:function(e){this.currentPage=e,this.updateVisibleOffers()},totalPages:function(){return Math.ceil(this.offers.length/this.pageSize)},showPreviousLink:function(){return 0!==this.currentPage},showNextLink:function(){return this.currentPage!==this.totalPages()-1},isAuthor:function(e){return this.$store.state.isUserLoggedIn&&e.author===this.$store.state.user._id},canCreateOffer:function(){return this.$store.state.isUserLoggedIn},getOption:function(e){return e.bidding&&1===e.biddingStatus?"Bidding not started":e.bidding||e.closed?e.closed?"Bought":e.bidding&&2===e.biddingStatus?"Bidding in progress":void 0:"Buy now"}},mounted:function(){var e=this;return Object(w["a"])(regeneratorRuntime.mark((function t(){return regeneratorRuntime.wrap((function(t){while(1)switch(t.prev=t.next){case 0:return t.next=2,N.index();case 2:e.offers=t.sent.data,e.updateVisibleOffers();case 4:case"end":return t.stop()}}),t)})))()}},D=A,z=(r("52af"),Object(f["a"])(D,j,T,!1,null,"3911db96",null)),M=z.exports,V=function(){var e=this,t=e.$createElement,r=e._self._c||t;return r("div",{staticClass:"offer-create"},[r("h3",[e._v("Create offer")]),r("input",{directives:[{name:"model",rawName:"v-model",value:e.offer.title,expression:"offer.title"}],attrs:{type:"text",name:"title",placeholder:"Title"},domProps:{value:e.offer.title},on:{input:function(t){t.target.composing||e.$set(e.offer,"title",t.target.value)}}}),r("br"),e._v(" Enable Bidding "),r("input",{directives:[{name:"model",rawName:"v-model",value:e.offer.bidding,expression:"offer.bidding"}],attrs:{type:"checkbox",name:"bidding",placeholder:"Bidding"},domProps:{checked:Array.isArray(e.offer.bidding)?e._i(e.offer.bidding,null)>-1:e.offer.bidding},on:{change:function(t){var r=e.offer.bidding,n=t.target,s=!!n.checked;if(Array.isArray(r)){var i=null,a=e._i(r,i);n.checked?a<0&&e.$set(e.offer,"bidding",r.concat([i])):a>-1&&e.$set(e.offer,"bidding",r.slice(0,a).concat(r.slice(a+1)))}else e.$set(e.offer,"bidding",s)}}}),r("br"),r("input",{directives:[{name:"model",rawName:"v-model",value:e.offer.price,expression:"offer.price"}],attrs:{type:"number",name:"price",placeholder:"Price"},domProps:{value:e.offer.price},on:{input:function(t){t.target.composing||e.$set(e.offer,"price",t.target.value)}}}),r("br"),r("button",{on:{click:e.create}},[e._v("Post Offer")])])},H=[],F={data:function(){return{offer:{title:null,bidding:!1,price:null,author:null}}},methods:{create:function(){var e=this;return Object(w["a"])(regeneratorRuntime.mark((function t(){return regeneratorRuntime.wrap((function(t){while(1)switch(t.prev=t.next){case 0:return t.prev=0,e.offer.author=e.$store.state.user._id,t.next=4,N.post(e.offer);case 4:e.$router.push({name:"offers"}),t.next=10;break;case 7:t.prev=7,t.t0=t["catch"](0),console.log(t.t0);case 10:case"end":return t.stop()}}),t,null,[[0,7]])})))()}},mounted:function(){this.$store.state.isUserLoggedIn||this.$router.push({name:"offers"})}},Y=F,G=(r("8996"),Object(f["a"])(Y,V,H,!1,null,"fc5566fc",null)),J=G.exports,Z=function(){var e=this,t=e.$createElement,r=e._self._c||t;return r("div",{staticClass:"offer-create"},[r("h1",[e._v("Offer Details")]),r("hr"),r("p",[e._v(" Title: "+e._s(e.offer.title)+" ")]),r("p",[e._v(" Price: "+e._s(e.offer.price)+" ")]),r("p",[e._v(" Is bidding enabled: "+e._s(e.offer.bidding)+" ")]),e._v(" Creator: "+e._s(e.author.username)+" "),r("hr"),!e.isAuthor(e.offer)&&e.isLoggedIn()?r("div",[r("button",{on:{click:function(t){return e.navigateTo({name:"chat",params:{userId:e.offer.author}})}}},[e._v(" Chat with creator ")])]):e._e(),r("br"),e.offer.closed?r("div",[e._v(" Already bought ")]):e._e(),e.canEdit?r("div",[r("button",{on:{click:function(t){return e.navigateTo({name:"offer-edit",params:{offerId:e.offer._id}})}}},[e._v(" Edit Offer ")])]):e._e(),e.canBuy?r("div",[r("button",{on:{click:e.buy}},[e._v(" Buy Offer ")])]):e._e(),e.canStartBidding?r("div",[r("button",{on:{click:e.startBid}},[e._v(" Start Bidding ")])]):e._e(),e.canFinishBidding?r("div",[r("button",{on:{click:e.finishBid}},[e._v(" Finish Bidding ")])]):e._e(),e.canEnterBidding?r("div",[r("bidding",{attrs:{offerId:e.offer._id}}),r("button",{on:{click:function(t){return e.navigateTo({name:"offer-bidding",params:{offerId:e.offer._id}})}}},[e._v(" Enter Bidding ")])],1):e._e()])},q=[],K=function(){var e=this,t=e.$createElement,r=e._self._c||t;return r("div",{staticClass:"mid-app"},[r("div",[r("h3",[e._v("Bidding for offer titled: "+e._s(e.offer.title))]),r("h3",[e._v(" Current price: "+e._s(e.offer.price))]),r("hr")]),r("div",[r("table",{staticClass:"mid-table"},e._l(e.bids,(function(t,n){return r("tr",{key:n},[r("td",[e._v(e._s(t.bidderName)+": ")]),r("td",[e._v(" "+e._s(t.price)+" ")])])})),0)]),r("div",[r("form",{on:{submit:function(t){return t.preventDefault(),e.sendMessage(t)}}},[r("div",[r("label",{attrs:{for:"price"}},[e._v("Your Bid:")]),r("input",{directives:[{name:"model",rawName:"v-model",value:e.price,expression:"price"}],attrs:{type:"number"},domProps:{value:e.price},on:{input:function(t){t.target.composing||(e.price=t.target.value)}}})]),r("button",{staticClass:"btn btn-success",attrs:{disabled:2!==e.offer.biddingStatus,type:"submit"}},[e._v("Send")])])])])},Q=[],W=r("8055"),X=r.n(W),ee={data:function(){return{offer:{},price:"",bids:[],socket:null}},methods:{sendMessage:function(){var e=this;return Object(w["a"])(regeneratorRuntime.mark((function t(){var r;return regeneratorRuntime.wrap((function(t){while(1)switch(t.prev=t.next){case 0:if(!(e.price>e.offer.price)){t.next=16;break}return t.prev=1,t.next=4,N.bid({offerId:e.offer._id,price:e.price});case 4:return e.socket.emit("SEND_BID",{bidderId:e.$store.state.user._id,bidderName:e.$store.state.user.username,price:e.price,offerId:e.offer._id}),console.log("bid made"),t.next=8,N.show(e.offer._id);case 8:r=t.sent.data,e.offer=r,e.price="",t.next=16;break;case 13:t.prev=13,t.t0=t["catch"](1),console.log(t.t0);case 16:case"end":return t.stop()}}),t,null,[[1,13]])})))()}},mounted:function(){var e=this;return Object(w["a"])(regeneratorRuntime.mark((function t(){var r,n;return regeneratorRuntime.wrap((function(t){while(1)switch(t.prev=t.next){case 0:if(e.$store.state.isUserLoggedIn){t.next=4;break}e.$router.push({name:"offers"}),t.next=20;break;case 4:return t.prev=4,e.socket=X()("wss://".concat(window.location.host)),r=e.$store.state.route.params.offerId,t.next=9,N.indexBids(r);case 9:return n=t.sent.data,e.bids=n,t.next=13,N.show(r);case 13:e.offer=t.sent.data,e.socket.on("BID",(function(t){console.log("bid received: "),console.log(t),console.log("this offer: "),console.log(e.offer),t.offerId===e.offer._id&&(e.bids.push(t),e.offer.price=t.price)})),t.next=20;break;case 17:t.prev=17,t.t0=t["catch"](4),console.log(t.t0);case 20:case"end":return t.stop()}}),t,null,[[4,17]])})))()}},te=ee,re=(r("b29b"),Object(f["a"])(te,K,Q,!1,null,"0eae99de",null)),ne=re.exports,se={components:{Bidding:ne},data:function(){return{offer:{},author:"",canBuy:!1,canEdit:!1,canStartBidding:!1,canFinishBidding:!1,canEnterBidding:!1}},methods:{navigateTo:function(e){this.$router.push(e)},buy:function(){var e=this;return Object(w["a"])(regeneratorRuntime.mark((function t(){return regeneratorRuntime.wrap((function(t){while(1)switch(t.prev=t.next){case 0:return t.prev=0,t.next=3,N.buy(e.offer);case 3:e.offer.closed=!0,e.canBuy=!1,t.next=10;break;case 7:t.prev=7,t.t0=t["catch"](0),console.log(t.t0);case 10:case"end":return t.stop()}}),t,null,[[0,7]])})))()},startBid:function(){var e=this;return Object(w["a"])(regeneratorRuntime.mark((function t(){var r;return regeneratorRuntime.wrap((function(t){while(1)switch(t.prev=t.next){case 0:return t.prev=0,t.next=3,N.start(e.offer);case 3:r=t.sent.data,e.offer=r,e.canStartBidding=!1,e.canFinishBidding=!0,t.next=12;break;case 9:t.prev=9,t.t0=t["catch"](0),console.log(t.t0);case 12:case"end":return t.stop()}}),t,null,[[0,9]])})))()},finishBid:function(){var e=this;return Object(w["a"])(regeneratorRuntime.mark((function t(){var r;return regeneratorRuntime.wrap((function(t){while(1)switch(t.prev=t.next){case 0:return t.prev=0,t.next=3,N.finish(e.offer);case 3:r=t.sent.data,e.offer=r,e.canFinishBidding=!1,t.next=11;break;case 8:t.prev=8,t.t0=t["catch"](0),console.log(t.t0);case 11:case"end":return t.stop()}}),t,null,[[0,8]])})))()},isAuthor:function(e){return this.$store.state.isUserLoggedIn&&e.author===this.$store.state.user._id},isLoggedIn:function(){return this.$store.state.isUserLoggedIn}},mounted:function(){var e=this;return Object(w["a"])(regeneratorRuntime.mark((function t(){var r;return regeneratorRuntime.wrap((function(t){while(1)switch(t.prev=t.next){case 0:return r=e.$store.state.route.params.offerId,t.next=3,N.show(r);case 3:return e.offer=t.sent.data,console.log(e.offer),t.next=7,$.show(e.offer.author);case 7:e.author=t.sent.data,e.$store.state.isUserLoggedIn&&(e.offer.author!==e.$store.state.user._id||e.offer.closed||1!==e.offer.biddingStatus?(console.log("cant edit"),e.canEdit=!1):(console.log("can edit"),e.canEdit=!0),e.offer.author!==e.$store.state.user._id||e.offer.closed||!0!==e.offer.bidding||(1===e.offer.biddingStatus&&(e.canStartBidding=!0),2===e.offer.biddingStatus&&(e.canFinishBidding=!0)),e.offer.author===e.$store.state.user._id||e.offer.closed||!0!==e.offer.bidding||2!==e.offer.biddingStatus||(e.canEnterBidding=!0),e.offer.author===e.$store.state.user._id||e.offer.closed||!1!==e.offer.bidding?(console.log("cant buy"),e.canBuy=!1):(console.log("can buy"),e.canBuy=!0),console.log("can edit: "+e.canEdit),console.log("can buy: "+e.canBuy));case 9:case"end":return t.stop()}}),t)})))()}},ie=se,ae=(r("9842"),Object(f["a"])(ie,Z,q,!1,null,"2e76baa9",null)),oe=ae.exports,ce=function(){var e=this,t=e.$createElement,r=e._self._c||t;return r("div",{staticClass:"offer-create"},[r("h3",[e._v("Edit offer")]),r("input",{directives:[{name:"model",rawName:"v-model",value:e.offer.title,expression:"offer.title"}],attrs:{type:"text",name:"title",placeholder:"Title"},domProps:{value:e.offer.title},on:{input:function(t){t.target.composing||e.$set(e.offer,"title",t.target.value)}}}),r("br"),e._v(" Enable Bidding "),r("input",{directives:[{name:"model",rawName:"v-model",value:e.offer.bidding,expression:"offer.bidding"}],attrs:{type:"checkbox",name:"bidding",placeholder:"Bidding"},domProps:{checked:Array.isArray(e.offer.bidding)?e._i(e.offer.bidding,null)>-1:e.offer.bidding},on:{change:function(t){var r=e.offer.bidding,n=t.target,s=!!n.checked;if(Array.isArray(r)){var i=null,a=e._i(r,i);n.checked?a<0&&e.$set(e.offer,"bidding",r.concat([i])):a>-1&&e.$set(e.offer,"bidding",r.slice(0,a).concat(r.slice(a+1)))}else e.$set(e.offer,"bidding",s)}}}),r("br"),r("input",{directives:[{name:"model",rawName:"v-model",value:e.offer.price,expression:"offer.price"}],attrs:{type:"number",name:"price",placeholder:"Price"},domProps:{value:e.offer.price},on:{input:function(t){t.target.composing||e.$set(e.offer,"price",t.target.value)}}}),r("br"),r("button",{on:{click:e.save}},[e._v("Save Offer")])])},ue=[],fe={data:function(){return{offer:{}}},methods:{save:function(){var e=this;return Object(w["a"])(regeneratorRuntime.mark((function t(){var r;return regeneratorRuntime.wrap((function(t){while(1)switch(t.prev=t.next){case 0:if(e.offer.author!==e.$store.state.user._id){t.next=14;break}return t.prev=1,r=e.$store.state.route.params.offerId,console.log("offerId => "+r),t.next=6,N.put(e.offer);case 6:e.$router.push({name:"offer",params:{offerId:r}}),t.next=12;break;case 9:t.prev=9,t.t0=t["catch"](1),console.log(t.t0);case 12:t.next=16;break;case 14:console.log("tylko autor moze editowac"),console.log(e.offer.author+" != "+e.$store.state.user._id);case 16:case"end":return t.stop()}}),t,null,[[1,9]])})))()}},mounted:function(){var e=this;return Object(w["a"])(regeneratorRuntime.mark((function t(){var r;return regeneratorRuntime.wrap((function(t){while(1)switch(t.prev=t.next){case 0:if(e.$store.state.isUserLoggedIn){t.next=4;break}e.$router.push({name:"offers"}),t.next=15;break;case 4:return t.prev=4,r=e.$store.state.route.params.offerId,t.next=8,N.show(r);case 8:e.offer=t.sent.data,console.log(e.offer),t.next=15;break;case 12:t.prev=12,t.t0=t["catch"](4),console.log(t.t0);case 15:case"end":return t.stop()}}),t,null,[[4,12]])})))()}},de=fe,le=(r("a4ac"),Object(f["a"])(de,ce,ue,!1,null,"488fbd53",null)),pe=le.exports,ge=function(){var e=this,t=e.$createElement,r=e._self._c||t;return r("div",{staticClass:"main-app"},[r("table",{staticClass:"cstTable"},[e._m(0),e._l(e.visibleOffers,(function(t){return r("tr",{key:t.id},[r("td",[e._v(" "+e._s(e.isAuthor(t)?"AUTHOR":"")+" "+e._s(!e.isAuthor(t)&&t.closed?"CLOSED":"")+" "+e._s(e.isAuthor(t)||t.closed?"":"OPEN")+" ")]),r("td",[e._v(e._s(t.title))]),r("td",[e._v(e._s(t.price))]),r("td",[e._v(e._s(e.getOption(t)))]),r("td",[r("button",{on:{click:function(r){return e.navigateTo({name:"offer",params:{offerId:t._id}})}}},[e._v(" View Offer ")])])])}))],2),e.totalPages()>0?r("div",{staticClass:"pagination"},[e.showPreviousLink()?r("span",{staticClass:"pagination-btn",on:{click:function(t){return e.updatePage(e.currentPage-1)}}},[e._v(" < ")]):e._e(),e._v(" "+e._s(e.currentPage+1)+" of "+e._s(e.totalPages())+" "),e.showNextLink()?r("span",{staticClass:"pagination-btn",on:{click:function(t){return e.updatePage(e.currentPage+1)}}},[e._v(" > ")]):e._e()]):e._e()])},he=[function(){var e=this,t=e.$createElement,r=e._self._c||t;return r("tr",[r("th",[e._v("Status")]),r("th",[e._v("Title")]),r("th",[e._v("Price")]),r("th",[e._v("Option")]),r("th",[e._v("Details")])])}],ve={data:function(){return{offers:{},visibleOffers:{},currentPage:0,pageSize:5}},methods:{navigateTo:function(e){this.$router.push(e)},updateVisibleOffers:function(){this.visibleOffers=this.offers.slice(this.currentPage*this.pageSize,this.currentPage*this.pageSize+this.pageSize),0===this.visibleOffers.length&&this.currentPage>0&&this.updatePage(this.currentPage-1)},updatePage:function(e){this.currentPage=e,this.updateVisibleOffers()},totalPages:function(){return Math.ceil(this.offers.length/this.pageSize)},showPreviousLink:function(){return 0!==this.currentPage},showNextLink:function(){return this.currentPage!==this.totalPages()-1},isAuthor:function(e){return this.$store.state.isUserLoggedIn&&e.author===this.$store.state.user._id},getOption:function(e){return e.bidding&&1===e.biddingStatus?"Bidding not started":e.bidding||e.closed?e.closed?"Bought":e.bidding&&2===e.biddingStatus?"Bidding in progress":void 0:"Buy now"}},mounted:function(){var e=this;return Object(w["a"])(regeneratorRuntime.mark((function t(){return regeneratorRuntime.wrap((function(t){while(1)switch(t.prev=t.next){case 0:if(e.$store.state.isUserLoggedIn){t.next=4;break}e.$router.push({name:"offers"}),t.next=9;break;case 4:return t.next=6,N.history();case 6:e.offers=t.sent.data,console.log(e.offers),e.updateVisibleOffers();case 9:case"end":return t.stop()}}),t)})))()}},me=ve,be=(r("04f1"),Object(f["a"])(me,ge,he,!1,null,"a19ceb20",null)),_e=be.exports,we=function(){var e=this,t=e.$createElement,r=e._self._c||t;return r("div",{staticClass:"main-app"},[r("table",{staticClass:"cstTable"},[e._m(0),e._l(e.visibleOffers,(function(t){return r("tr",{key:t.id},[r("td",[e._v(" "+e._s(e.isAuthor(t)?"AUTHOR":"")+" "+e._s(!e.isAuthor(t)&&t.closed?"CLOSED":"")+" "+e._s(e.isAuthor(t)||t.closed?"":"OPEN")+" ")]),r("td",[e._v(e._s(t.title))]),r("td",[e._v(e._s(t.price))]),r("td",[e._v(e._s(e.getOption(t)))]),r("td",[r("button",{on:{click:function(r){return e.navigateTo({name:"offer",params:{offerId:t._id}})}}},[e._v(" View Offer ")])]),r("td",[r("input",{directives:[{name:"model",rawName:"v-model",value:e.price,expression:"price"}],attrs:{type:"number",name:"price",placeholder:"price"},domProps:{value:e.price},on:{input:function(t){t.target.composing||(e.price=t.target.value)}}}),r("button",{on:{click:function(r){return e.dynamicBid(t,e.index)}}},[e._v(" Bid ")])])])}))],2),e.totalPages()>0?r("div",{staticClass:"pagination"},[e.showPreviousLink()?r("span",{staticClass:"pagination-btn",on:{click:function(t){return e.updatePage(e.currentPage-1)}}},[e._v(" < ")]):e._e(),e._v(" "+e._s(e.currentPage+1)+" of "+e._s(e.totalPages())+" "),e.showNextLink()?r("span",{staticClass:"pagination-btn",on:{click:function(t){return e.updatePage(e.currentPage+1)}}},[e._v(" > ")]):e._e()]):e._e()])},xe=[function(){var e=this,t=e.$createElement,r=e._self._c||t;return r("tr",[r("th",[e._v("Status")]),r("th",[e._v("Title")]),r("th",[e._v("Price")]),r("th",[e._v("Option")]),r("th",[e._v("Details")]),r("th",[e._v("Make new bid")])])}],ke={data:function(){return{offers:{},visibleOffers:{},price:0,currentPage:0,pageSize:5,socket:X()("https://localhost:8081")}},methods:{navigateTo:function(e){this.$router.push(e)},updateVisibleOffers:function(){this.visibleOffers=this.offers.slice(this.currentPage*this.pageSize,this.currentPage*this.pageSize+this.pageSize),0===this.visibleOffers.length&&this.currentPage>0&&this.updatePage(this.currentPage-1)},updatePage:function(e){this.currentPage=e,this.updateVisibleOffers()},totalPages:function(){return Math.ceil(this.offers.length/this.pageSize)},showPreviousLink:function(){return 0!==this.currentPage},showNextLink:function(){return this.currentPage!==this.totalPages()-1},isAuthor:function(e){return this.$store.state.isUserLoggedIn&&e.author===this.$store.state.user._id},getOption:function(e){return e.bidding&&1===e.biddingStatus?"Bidding not started":e.bidding||e.closed?e.closed?"Bought":e.bidding&&2===e.biddingStatus?"Bidding in progress":void 0:"Buy now"},dynamicBid:function(e,t){var r=this;return Object(w["a"])(regeneratorRuntime.mark((function n(){return regeneratorRuntime.wrap((function(n){while(1)switch(n.prev=n.next){case 0:if(!(r.price>e.price)){n.next=11;break}return n.prev=1,n.next=4,N.bid({offerId:e._id,price:r.price});case 4:r.socket.emit("SEND_BID",{bidderId:r.$store.state.user._id,bidderName:r.$store.state.user.username,price:r.price,offerId:e._id}),r.offers[t].price=r.price,n.next=11;break;case 8:n.prev=8,n.t0=n["catch"](1),console.log(n.t0);case 11:case"end":return n.stop()}}),n,null,[[1,8]])})))()}},mounted:function(){var e=this;return Object(w["a"])(regeneratorRuntime.mark((function t(){return regeneratorRuntime.wrap((function(t){while(1)switch(t.prev=t.next){case 0:if(e.$store.state.isUserLoggedIn){t.next=4;break}e.$router.push({name:"offers"}),t.next=8;break;case 4:return t.next=6,N.historyBidding();case 6:e.offers=t.sent.data,e.updateVisibleOffers();case 8:case"end":return t.stop()}}),t)})))()}},Pe=ke,$e=(r("74ac"),Object(f["a"])(Pe,we,xe,!1,null,"07d900fc",null)),Oe=$e.exports,ye=function(){var e=this,t=e.$createElement,r=e._self._c||t;return r("div",{staticClass:"main-app"},[r("table",{staticClass:"cstTable"},[e._m(0),e._l(e.visibleUsers,(function(t){return r("tr",{key:t.id},[r("td",[e._v(e._s(t.username))]),r("td",[r("button",{on:{click:function(r){return e.navigateTo({name:"chat",params:{userId:t._id}})}}},[e._v(" View Chat ")])])])}))],2),e.totalPages()>0?r("div",{staticClass:"pagination"},[e.showPreviousLink()?r("span",{staticClass:"pagination-btn",on:{click:function(t){return e.updatePage(e.currentPage-1)}}},[e._v(" < ")]):e._e(),e._v(" "+e._s(e.currentPage+1)+" of "+e._s(e.totalPages())+" "),e.showNextLink()?r("span",{staticClass:"pagination-btn",on:{click:function(t){return e.updatePage(e.currentPage+1)}}},[e._v(" > ")]):e._e()]):e._e()])},Ie=[function(){var e=this,t=e.$createElement,r=e._self._c||t;return r("tr",[r("th",[e._v("Username")]),r("th",[e._v("Details")])])}],Be={index:function(){return P().get("chats")},show:function(e){return P().get("chats/".concat(e))},post:function(e){return P().post("chats",e)},getNotes:function(){return P().get("notes")}},Se={data:function(){return{users:{},visibleUsers:{},currentPage:0,pageSize:5}},methods:{navigateTo:function(e){this.$router.push(e)},updateVisibleUsers:function(){this.visibleUsers=this.users.slice(this.currentPage*this.pageSize,this.currentPage*this.pageSize+this.pageSize),0===this.visibleUsers.length&&this.currentPage>0&&this.updatePage(this.currentPage-1)},updatePage:function(e){this.currentPage=e,this.updateVisibleUsers()},totalPages:function(){return Math.ceil(this.users.length/this.pageSize)},showPreviousLink:function(){return 0!==this.currentPage},showNextLink:function(){return this.currentPage!==this.totalPages()-1}},mounted:function(){var e=this;return Object(w["a"])(regeneratorRuntime.mark((function t(){return regeneratorRuntime.wrap((function(t){while(1)switch(t.prev=t.next){case 0:if(e.$store.state.isUserLoggedIn){t.next=4;break}e.$router.push({name:"offers"}),t.next=8;break;case 4:return t.next=6,Be.index();case 6:e.users=t.sent.data,e.updateVisibleUsers();case 8:case"end":return t.stop()}}),t)})))()}},Ce=Se,Le=(r("19fc"),Object(f["a"])(Ce,ye,Ie,!1,null,"60dafe77",null)),Ue=Le.exports,Ee=function(){var e=this,t=e.$createElement,r=e._self._c||t;return r("div",{staticClass:"mid-app"},[r("div",[r("h3",[e._v("Chat with user: "+e._s(e.receiver.username))]),r("hr"),r("table",{staticClass:"main-table",attrs:{id:"chatbox"}},e._l(e.messages,(function(t,n){return r("tr",{key:n},[r("td",[e._v(" "+e._s(e.formatDate(new Date(t.createdAt)))+", ")]),r("td",[e._v(e._s(t.senderId===e.currentUserId?e.currentUserUserName:e.receiver.username)+": ")]),r("td",[e._v(" "+e._s(t.text)+" ")])])})),0)]),r("div",[r("form",{on:{submit:function(t){return t.preventDefault(),e.sendMessage(t)}}},[r("div",[r("input",{directives:[{name:"model",rawName:"v-model",value:e.message,expression:"message"}],attrs:{type:"text"},domProps:{value:e.message},on:{input:function(t){t.target.composing||(e.message=t.target.value)}}})]),r("button",{attrs:{type:"submit"}},[e._v("Send")])])])])},Re=[],je={data:function(){return{receiver:{},currentUserId:"",currentUserUserName:"",message:"",messages:[],socket:null}},methods:{sendMessage:function(){var e=this;return Object(w["a"])(regeneratorRuntime.mark((function t(){var r,n;return regeneratorRuntime.wrap((function(t){while(1)switch(t.prev=t.next){case 0:if(!(e.message.length>0)){t.next=16;break}return t.prev=1,r=new Date,t.next=5,Be.post({senderId:e.$store.state.user._id,receiverId:e.receiver._id,text:e.message,createdAt:r});case 5:return e.socket.emit("SEND_MESSAGE",{senderId:e.$store.state.user._id,receiverId:e.receiver._id,text:e.message,createdAt:r}),t.next=8,Be.show(e.receiver._id);case 8:n=t.sent.data,e.messages=n,e.message="",t.next=16;break;case 13:t.prev=13,t.t0=t["catch"](1),console.log(t.t0);case 16:case"end":return t.stop()}}),t,null,[[1,13]])})))()},formatDate:function(e){return e.getDate()+"/"+e.getMonth()+"/"+e.getFullYear()+" - "+e.getHours()+":"+e.getMinutes()+":"+e.getSeconds()}},mounted:function(){var e=this;return Object(w["a"])(regeneratorRuntime.mark((function t(){var r,n;return regeneratorRuntime.wrap((function(t){while(1)switch(t.prev=t.next){case 0:if(e.$store.state.isUserLoggedIn){t.next=4;break}e.$router.push({name:"offers"}),t.next=23;break;case 4:return t.prev=4,e.socket=X()("wss://".concat(window.location.host)),r=e.$store.state.route.params.userId,t.next=9,$.show(r);case 9:return n=t.sent.data,e.receiver=n,e.receiverId=n._id,e.currentUserId=e.$store.state.user._id,e.currentUserUserName=e.$store.state.user.username,t.next=16,Be.show(r);case 16:e.messages=t.sent.data,e.socket.on("MESSAGE",(function(t){console.log("got message"),console.log("if (("+t.receiverId+"==="+e.receiverId+"&&"+t.senderId+"==="+e.$store.state.user._id+") || ("+t.receiverId+"==="+e.$store.state.user._id+"&&"+t.senderId+"==="+e.receiverId+"))"),(t.receiverId===e.receiverId&&t.senderId===e.$store.state.user._id||t.receiverId===e.$store.state.user._id&&t.senderId===e.receiverId)&&(console.log("validated message"),e.messages.push(t))})),t.next=23;break;case 20:t.prev=20,t.t0=t["catch"](4),console.log(t.t0);case 23:case"end":return t.stop()}}),t,null,[[4,20]])})))()}},Te=je,Ne=(r("3f4c"),Object(f["a"])(Te,Ee,Re,!1,null,"24ebac26",null)),Ae=Ne.exports,De=function(){var e=this,t=e.$createElement,r=e._self._c||t;return r("div",{staticClass:"noteBox"},[r("p",{staticClass:"noteBoxText"},[e._v("You have "+e._s(e.notes.length)+" new notifications!")]),e._l(e.notes,(function(t){return r("div",{key:t.id,staticClass:"noteBoxText"},[e._v(" "+e._s(t.senderUserName)+" has sent you new message! Check your chats ")])}))],2)},ze=[],Me={data:function(){return{notes:{}}},mounted:function(){var e=this;return Object(w["a"])(regeneratorRuntime.mark((function t(){return regeneratorRuntime.wrap((function(t){while(1)switch(t.prev=t.next){case 0:return t.next=2,Be.getNotes();case 2:e.notes=t.sent.data,0===e.notes.length&&e.$router.push({name:"offers"});case 4:case"end":return t.stop()}}),t)})))()}},Ve=Me,He=(r("ec51"),Object(f["a"])(Ve,De,ze,!1,null,"301e9656",null)),Fe=He.exports;n["a"].use(m["a"]);var Ye=new m["a"]({routes:[{path:"/register",name:"register",component:B},{path:"/login",name:"login",component:R},{path:"/offers",name:"offers",component:M},{path:"/offers/create",name:"offers-create",component:J},{path:"/offers/:offerId",name:"offer",component:oe},{path:"/offers/:offerId/edit",name:"offer-edit",component:pe},{path:"/offers/:offerId/bidding",name:"offer-bidding",component:ne},{path:"/history",name:"history",component:_e},{path:"/historyBidding",name:"history-bidding",component:Oe},{path:"/chats",name:"chats",component:Ue},{path:"/chats/:userId",name:"chat",component:Ae},{path:"/notifications",name:"notifications",component:Fe},{path:"*",redirect:"offers"}]}),Ge=r("31bd"),Je=r("2f62"),Ze=r("0e44");n["a"].use(Je["a"]);var qe=new Je["a"].Store({strict:!0,plugins:[Object(Ze["a"])({storage:window.sessionStorage})],state:{token:null,user:null,isUserLoggedIn:!1},mutations:{login:function(e,t){e.user=t,e.isUserLoggedIn=!0},logout:function(e){sessionStorage.clear(),e.user=null,e.isUserLoggedIn=!1},setToken:function(e,t){e.token=t,e.isUserLoggedIn=!!t},setUser:function(e,t){e.user=t}},actions:{setToken:function(e,t){var r=e.commit;r("setToken",t)},setUser:function(e,t){var r=e.commit;r("setUser",t)}}}),Ke=r("2b27"),Qe=r.n(Ke);n["a"].config.productionTip=!1,n["a"].use(Qe.a),Object(Ge["sync"])(qe,Ye),new n["a"]({el:"#app",router:Ye,store:qe,components:{App:v},template:"<App/>"})},"6ab1":function(e,t,r){"use strict";var n=r("522d"),s=r.n(n);s.a},"6fe9":function(e,t,r){},"74ac":function(e,t,r){"use strict";var n=r("2d5e"),s=r.n(n);s.a},"7eab":function(e,t,r){},8137:function(e,t,r){"use strict";var n=r("f5d4"),s=r.n(n);s.a},8996:function(e,t,r){"use strict";var n=r("c891"),s=r.n(n);s.a},9842:function(e,t,r){"use strict";var n=r("7eab"),s=r.n(n);s.a},a4ac:function(e,t,r){"use strict";var n=r("f824"),s=r.n(n);s.a},b29b:function(e,t,r){"use strict";var n=r("1290"),s=r.n(n);s.a},b4d2:function(e,t,r){"use strict";var n=r("ee9e"),s=r.n(n);s.a},c891:function(e,t,r){},d694:function(e,t,r){},ec51:function(e,t,r){"use strict";var n=r("38ea"),s=r.n(n);s.a},ee9e:function(e,t,r){},f5d4:function(e,t,r){},f824:function(e,t,r){}});
//# sourceMappingURL=app.a660b1d9.js.map